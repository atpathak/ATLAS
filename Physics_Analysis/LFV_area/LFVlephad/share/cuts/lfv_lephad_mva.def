# -*- mode:tqfolder -*-

+CutBase{
  <.cutExpression = "1.", .weightExpression = "{$(isData) ? 1. : [ScaleFactor_$(weightvariation)]}", .title = "Baseline">
  +CutChannel{
    <.cutExpression = "$(fitsChannel)", .title = "Channel">
    +CutHadTau{
      <.cutExpression = "{$(isSignal) ? (abs(tau_0_truth_pdgId)==15) : 1.}", .title = "Had Tau">
      +CutVBFFilter{
        <.cutExpression = "{$(isData) ? 1 : (truth_passedVBFFilter == 0)}", .title = "VBF Filter">
        +CutTrigger{
          <.cutExpression = "[Trigger] == 1", .title = "Trigger" >
          +CutNPVX{
            <.cutExpression = "n_pvx > 0", .title = "NPVX">
	    +CutLepQual{
              <.cutExpression = "{$(isETAU) ? lep_0_id_medium == 1 && lep_0_iso_Gradient == 1 && fabs(lep_0_eta) < 2.47 && !(fabs(lep_0_eta)>1.37 && fabs(lep_0_eta)<1.52) : lep_0_id_medium == 1 && lep_0_iso_Gradient == 1 && fabs(lep_0_eta) < 2.5}", .title = "LepQual">
              +CutTauQual{
                <.cutExpression = "n_taus > 0 && abs(tau_0_q) == 1 && abs(tau_0_eta) < 2.4 && !(fabs(tau_0_eta)>1.37 && fabs(tau_0_eta)<1.52)", .title = "TauQual">
                +CutOS{
                  <.cutExpression = "lephad_qxq == -1", .title = "OS">
                  +CutTauAntiTau{
		    <.cutExpression = "{$(isFailID) ? (tau_0_jet_bdt_tight == 0  && tau_0_jet_bdt_score > 0.5) : (tau_0_jet_bdt_tight == 1)}", .title = "TauAntiTau">
	            +CutNoJetFake{
	              <.cutExpression = "{$(isData) ? 1. : !(abs(tau_0_truth_pdgId) < 6 || tau_0_truth_pdgId == 21)}", .title = "NoJetFake" >
                      +CutLepPt{
                        <.cutExpression = "lep_0_pt > 27.3", .title = "MuonPt">
                        +CutTauPt{
                          <.cutExpression = "tau_0_pt > 25.", .title = "TauPt">
                          +CutZVeto{
		            #<.cutExpression = "{$(isETAU) ? (tau_0_n_tracks==1 && tau_0_ele_BDTEleScoreTrans_run2 > 0.15) || (tau_0_n_tracks==3 && tau_0_ele_BDTEleScoreTrans_run2 > 0.05) : 1.}", .title = "ZVeto">
			    <.cutExpression = "{$(isETAU) ? (tau_0_n_tracks==1) || (tau_0_n_tracks==3 && tau_0_ele_BDTEleScoreTrans_run2 > 0.05) : 1.}", .title = "ZVeto">
			    +CutFake{
                              <.cutExpression = "1.", .title = "Preselection", .weightExpression = "{$(isFailID) ? [fakeFactorPreselectionSR_$(fakevariation)] : 1.}">
			      #<.cutExpression = "1.", .title = "Preselection">
			      +CutCosDPhi{
                                <.cutExpression = "( cos($(dPhiTauMET)) + cos($(dPhiLepMET)) ) > -2.0", .title = "CosDPhi">
			        +CutDEta{
			          <.cutExpression = "abs(lep_0_eta - tau_0_eta) < 2.", .title = "MuonPt">
			          +CutNbjets{
                                    <.cutExpression = "n_bjets == 0", .title = "MuonPt">
                                    +CutPreselection1{
                                      <.cutExpression = "{$(isEFake) ? ((tau_0_n_tracks==1 && tau_0_ele_BDTEleScoreTrans_run2 < 0.15) || tau_0_n_tracks==3) : 1}", .title = "Preselection", .weightExpression = "{ ( $(isFailID) ) ? [fakeFactorPreselectionSR0_$(fakevariation)]/[fakeFactorPreselectionSR_$(fakevariation)] : 1.}">
				      #<.cutExpression = "{$(isEFake) ? ((tau_0_n_tracks==1 && tau_0_ele_BDTEleScoreTrans_run2 < 0.15) || tau_0_n_tracks==3) : 1}", .title = "Preselection">
				      #<.cutExpression = "{$(isEFake) ? ((tau_0_n_tracks==1 && tau_0_ele_BDTEleScoreTrans_run2 < 0.15) || tau_0_n_tracks==3) : 1}", .title = "Preselection", .weightExpression = "{ ( $(isFailID) ) ? [fakeFactorPreselectionSR0_$(fakevariation)] : 1.}">
				      +CutPreselection{
				        #<.cutExpression = "1.", .title = "Preselection">
                                        <.cutExpression = "{($(isETAU) && !$(isEFake)) ? (tau_0_n_tracks==1 && tau_0_ele_BDTEleScoreTrans_run2 > 0.15) || (tau_0_n_tracks==3) : 1.}", .title = "Preselection", .weightExpression = "{ ( $(isEFake) && [tau_0_n_tracks==1]) ? [eFakeFactorPreselection_$(efakevariation)] : 1.}">
				      }
				    }
			    	  }
				}
			      }
			    }
			  }
			}
		      }
		    }
		  }
		}
	      }
            }
	  }
	}
      }
    }
  }
}

@*/CutPreselection {
  +Cut01jet{
    <.cutExpression = "n_jets < 2", .title = "Njets cut">
  }
  +Cut2jet{
    <.cutExpression = "n_jets >= 2", .title = "Njets cut">
  }
}





